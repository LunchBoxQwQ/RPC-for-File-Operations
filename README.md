# RPC-for-File-Operations
 Remote procedure calls system allowing file operations. 

In Project 1, I designed and implemented a remote procedure calls system to allow file operations. Specifically, I managed to handle standard C library calls open, close, write... as well as two non-standard calls getdirtree and freedirtree. In this document, I will specify the overall idea as well as some features of my design.

First of all, the very basic idea of my serialization is to use the strings in an ”expressive” way. When the client want to call a function, the function’s parameters need to be sent to the server through the socket. Sincere almost all the implemented functions have distinct parameters, I designed a basic outside structure that packs the basic information for all the functions to transmit from client to server, and for each function I also designed inside structures specifically to handle different kinds of parameters. The outside structure has fields to indicate server the total length of the sent string, which implies the total size of the transmitted information; it also has a operation code, which is just an integer, to indicate which function is been called by the client.The third field of the outside structure is a char array of size 0 initially. Once we have created the inside structure for each function we called, we use memcpy to ”concat” the inside structure to the outside structure, so after we specify the length of content correctly, the send function will send not only the outside structure, but also the insider structure because of the effect of this field. As for the inside structures, different functions have different design, but the basic idea is to give field directly to non-array parameters, and give length field as well as content field for the array parameters.

Second, for transporting information from server to client, the situation is a little bit easier: for most of the cases we only need to give the return result of evoked function and the error number, so it is sufficient to use char arrays for transmitting, by casting parts of the array into proper data type’s pointer to include the information we need (memcpy is still the most powerful and convenient tool I’m using). However, for functions such as read,getdirentries, getdirtree etc., we also need to include detailed information such as length of the transmitted string, and content such as the content been read, and the tree made by server. Most of the time the content can be directly used as strings, but for getdirtree function, things become different since the return type is a tree. For that function specifically, I use DFS algorithm to go through the whole tree twice: one time to know the exact size of the tee, and the other time to memcpy the information of each node: length of name, name, and number of subdirs sequentially into the string I’m going to send. In this fashion, I’m able to construct the exactly same tree in the client end since the order of information in the received string matches up the searching procedure of DFS. Overall the most useful strategies I applied for the serialization are memcpy, type casting back and forth between char* and target data type, as well as the convenience brought by using C structs. Sometimes I will use MSG WAITALL flag to make sure that I receive all the information. For more information, please check my code. 

Thank you for reading!
